(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();var m="http://localhost:3000/api";const y=document.getElementById("navToggle"),f=document.getElementById("navLinks"),u=document.getElementById("darkToggle"),g=document.getElementById("convertBtn"),p=document.getElementById("downloadForm"),c=document.getElementById("loader"),i=document.getElementById("errorBox"),v=document.getElementById("trackImage"),h=document.getElementById("trackTitle"),I=document.getElementById("trackArtist"),a=document.getElementById("progress-bar"),d=document.getElementById("urlInput");async function E(r){const e="songs/getTrackData?song_url="+r,o=await L(e);if(!o)return alert("Failed to fetch data. Please try again."),d.value="",c.style.display="none",!1;const{artistName:s,songName:t,images:n}=o.songDetails;return v.src=n[0].url,h.innerHTML=t,I.innerHTML=s,c.style.display="none",!0}function k(r){return/^https:\/\/open\.spotify\.com\/track\/[a-zA-Z0-9]+(\?si=[a-zA-Z0-9]+)?$/.test(r)}async function L(r){try{const e={method:"GET",headers:{"Content-Type":"application/json"}},o=await fetch(`${m}/${r}`,e);if(!o.ok)throw new Error(`HTTP error! Status: ${o.status} - ${o.statusText}`);return await o.json()}catch(e){return console.error("Fetch failed:",e.message),null}}g.addEventListener("click",r=>{r.preventDefault();const e=d.value.trim();if(!k(e)){d.value="",alert("Please enter a valid Spotify URL");return}i.style.display="none",c.style.display="flex",E(e)});p.addEventListener("submit",B);y.addEventListener("click",()=>{f.classList.toggle("active")});u.addEventListener("click",()=>{document.body.classList.toggle("dark"),u.textContent=document.body.classList.contains("dark")?"☀️":"🌙"});async function B(r){r.preventDefault(),i.style.display="none";let e=0;a.style.width="0%",a.style.backgroundColor="#28a745";const o=Math.floor(Math.random()*51)+40,s=setInterval(()=>{if(e+=2,e>=o&&e<100){clearInterval(s),console.error(`Download failed at ${e}%`),a.style.backgroundColor="red",i.style.display="block";return}a.style.width=`${e}%`,e>=100&&(clearInterval(s),console.log("Download completed successfully"))},300)}
